{
  "licenseDirectoryPath" : "/gpfs/projects/bsc72/PELE++/license",
  "simulationLogPath" : "$OUTPUT_PATH/logFile.txt",
  "Initialization" : {
     "allowMissingTerminals" :true,
     "ForceField" : "OPLS2005",
     "MultipleComplex": [ $COMPLEXES ],
     "Solvent" : { "ionicStrength" : 0.15, "solventType" : "VDGBNP", "useDebyeLength" : true }
   },
   "commands" : [
      {
         "commandType" : "peleSimulation",
         "RandomGenerator" : { "seed" : $SEED },
         "selectionToPerturb" : { "chains" : { "names" : [ "L" ] } },
         "PELE_Output" : {
            "savingFrequencyForAcceptedSteps" : 1,
            "savingMode" : "savingTrajectory",
            "reportPath" : "$OUTPUT_PATH/report",
            "trajectoryPath" : "$OUTPUT_PATH/trajectory.pdb"
         },
         "PELE_Parameters" : {
                "anmFrequency" : 2,
	        "sideChainPredictionFrequency" : 2,
                "waterPerturbationFrequency": 1,
	        "minimizationFrequency" : 1,
                "sideChainPredictionRegionRadius" : 4,
	        "perturbationCOMConstraintConstant" : 1.0,
	        "activateProximityDetection": true,
                "temperature": 1000,
                "numberOfPeleSteps": $PELE_STEPS
         },
          "constraints":[
                       { "type": "constrainAtomToPosition", "springConstant": 2.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:1:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:10:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:20:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:30:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:40:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:50:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:60:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:70:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:80:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:90:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:100:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:110:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:120:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:130:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:140:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 0.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:150:_CA_" },
                       { "type": "constrainAtomToPosition", "springConstant": 2.5, "equilibriumDistance": 0.0, "constrainThisAtom": "A:157:_CA_" }
                        ],
          "Perturbation": {
               "Box" : {
                	"radius" : 35,
                	"fixedCenter": [48.65, 24.8, 41.06],
                	"type" : "sphericalBox"
                },
                "perturbationType":"naive",
                "translationDirection": "steered",
                "rotationAngles": "nonCoupled",
                "parameters": {
                    "numberOfStericTrials": 100,
                    "steeringUpdateFrequency": 1,
                    "overlapFactor": 0.65
                }
            },
          "WaterPerturbation":
          {
              "Box" :
              {
                  "radius" : 10,
                  "fixedCenter": [48.65, 24.8, 41.06],
                  "type" : "sphericalBox"
              },
              "watersToPerturb": { "links": { "ids": [ "B:1" ] } },
              "parameters":
              {
                  "temperature": 1000,
                  "overlapFactor": 0.78,
                  "numberOfStericTrials": 10000,
                  "COMConstraintConstant": 0
              }
          },
          "ANM" : {
            "algorithm": "CARTESIANS", "nodes": { "atoms": { "names": [ "_CA_" ]} },
            "linksToOmit" : { "links" : { "ids" : [ "B:1" ] }},
            "ANMMinimizer" : {
               "algorithm" : "TruncatedNewton",
               "parameters" : {
                  "MaximumMinimizationIterations" : 1,
                  "MaximumNewtonIterations" : 25,
                  "MinimumRMS" : 0.25,
                  "alphaUpdated" : false,
                  "nonBondingListUpdatedEachMinStep" : false
               }
            },
            "options" : {
               "directionGeneration" : "random",
               "modesMixingOption" : "mixMainModeWithOthersModes",
               "pickingCase" : "RANDOM_MODE"
            },
            "parameters" : {
               "displacementFactor" : 0.75,
               "eigenUpdateFrequency" : 1000000,
               "mainModeWeightForMixModes" : 0.75,
               "modesChangeFrequency" : 3,
               "numberOfModes": 6,
               "relaxationSpringConstant" : 0.5
            }
         },
         "SideChainPrediction" : {
            "algorithm" : "zhexin",
            "parameters" : { "discardHighEnergySolutions" : false, "resolution": 30, "randomize" : false, "numberOfIterations": 1 }
         },
         "Minimizer" : {
            "algorithm" : "TruncatedNewton",
            "parameters" : { "MinimumRMS" : 0.1, "alphaUpdated" : false, "nonBondingListUpdatedEachMinStep" : true }
         },

         "PeleTasks" : [
            {
               "metrics" : [
                        { "type": "bindingEnergy",
                           "boundPartSelection": { "chains": { "names": ["L"] } }
                        },
                        { "type": "sasa",
                           "tag": "sasaLig",
                           "selection": { "chains": { "names": ["L"] } }
                        },
                        {
                           "type": "rmsd",
                                "Native": {
                                   "path": "PDB/1ZNK_original.pdb"
                                },
                            "selection": {
                                "chains": {
                                "names": [ "L" ]
                                   }
                               },
                           "doSuperposition": false,
                           "includeHydrogens": false,
                           "tag" : "rmsd"
                        },
                        {
                           "type":"com_distance",
                           "tag":"H2O-Lig_distance",
                           "selection_group_1":{
                              "links": { "ids":["B:1"]}
                           },
                           "selection_group_2":{
                              "atoms": { "ids":["L:1: H20"]}
                           }
                        },
                        {
                           "type":"com_distance",
                           "tag":"Lig-Phe38_distance",
                           "selection_group_1":{
                              "atoms": { "ids":["A:38: O  "]}
                           },
                           "selection_group_2":{
                              "atoms": { "ids":["L:1: H20"]}
                           }
                        },
                        {
                           "type": "bindingEnergy",
                           "boundPartSelection": { "chains": { "names": ["B"] } },
                           "tag": "waterBEnergy"
                        },
                        { "tag" : "rand", "type" : "random" },
                        { "tag" : "rand1", "type" : "random" }
                     ],

                 "parametersChanges" : [
                     { "ifAnyIsTrue": [ "rand >= .5" ],
                         "doThesechanges": { "Perturbation::parameters": { "rotationScalingFactor": 0.05 } },
                         "otherwise": { "Perturbation::parameters": { "rotationScalingFactor": 0.20 } }
                     },
                     { "ifAnyIsTrue": [ "rand1 >= 0.5" ],
                         "doThesechanges": { "Perturbation::parameters": { "translationRange": 2.0, "numberOfTrials" : 15 } },
                         "otherwise": { "Perturbation::parameters": { "translationRange": 1.0, "numberOfTrials" : 15 } }
                     },
                     { "ifAnyIsTrue": [ "sasaLig >= 0.85" ],
                         "doThesechanges": { "Perturbation::parameters": { "translationRange": 4.0, "numberOfTrials" : 40 } },
                         "otherwise": {  }
                     }
                  ]
            }
         ]
        }
        ]
 }

